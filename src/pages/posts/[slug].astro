---
import type { GetStaticPaths, InferGetStaticPropsType } from "astro";
import PostLayout from "@/layouts/BlogPost";
import { getAllPosts } from "@/utils";

export const getStaticPaths = (async () => {
	const blogEntries = await getAllPosts();
	return blogEntries.map((entry) => ({
		params: { slug: entry.slug },
		props: { entry },
	}));
}) satisfies GetStaticPaths;

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<PostLayout post={entry}>
	<Content />
	<script
		src="https://giscus.app/client.js"
		data-repo="d4mr/d4mr.github.io"
		data-repo-id="R_kgDOKU7qjQ"
		data-category="giscus"
		data-category-id="DIC_kwDOKU7qjc4CZZ80"
		data-mapping="pathname"
		data-strict="0"
		data-reactions-enabled="1"
		data-emit-metadata="0"
		data-input-position="top"
		data-theme="transparent_dark"
		data-lang="en"
		data-loading="lazy"
		crossorigin="anonymous"
		async></script>
</PostLayout>
